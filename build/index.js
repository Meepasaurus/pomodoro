"use strict";var Timer=function(e,t){var s=$("#slice"),i=$(".counter").find("p"),a=$("#title"),o=$("#pulse"),n=$("#session-minutes-tens"),r=$("#session-minutes-ones"),c=$("#session-seconds-tens"),u=$("#session-seconds-ones"),l=document.getElementById("notification"),d="white",g="#263238",p="session",h="true",k=e,m=t,f=0,b=0,S=!1,x="",v=!1;return k>5999&&(k=5999),m>5999&&(m=5999),{updateCounter:function(){var e="",t="",s=Math.floor(b/60),a=b%60;a<10&&(e="0"),s<10&&(t="0"),i.text(t+s+":"+e+a)},updateClock:function(){var e=b/f*360;360===e&&("session"===p?a.text("Session"):a.text("Break")),0===e?s.css({"background-color":"#263238"}):e<=180?(e+=90,s.css({"background-color":d,"background-image":"linear-gradient("+e+"deg, transparent 50%, "+g+" 50%),linear-gradient(90deg, "+g+" 50%, transparent 50%)"})):e<360?(e-=90,s.css({"background-color":d,"background-image":"linear-gradient("+e+"deg, transparent 50%, white 50%),linear-gradient(90deg, "+g+" 50%, transparent 50%)"})):s.css({"background-image":"none","background-color":d}),this.updateCounter(),0===b?(this.startStop(),o.addClass("pulse"),window.setTimeout(function(){$("#pulse").removeClass("pulse")},1e3),"session"===p?(this.playAudio(),0===m?(b=k,f=k):(p="break",b=m,f=m),this.startStop()):(this.playAudio(),0===k?(b=m,f=m):(p="session",b=k,f=k),this.startStop())):b--},startStop:function(){S=!0,v?(window.clearInterval(x),v=!1):0===k&&0===m||(x=window.setInterval(this.updateClock.bind(this),1e3),v=!0)},playAudio:function(){h&&(l.pause(),l.currentTime=0,l.play())},setAudio:function(e){switch(e){case"off":h=!1;break;case"chime":l.src="audio/chime.mp3",h=!0;break;case"bleep":l.src="audio/bleep.mp3",h=!0;break;case"moo":l.src="audio/moo.mp3",h=!0}localStorage.setItem("audio",e)},setSettingsTimer:function(e,t){e=e.toString();var s=e.slice(0,1),i=Number(e.slice(1)),a=0,o=0;if("session"===t?(a=this.parseFourDigits(k),o=k):(a=this.parseFourDigits(m),o=m),"+"===s)switch(i){case 1:o=9===a[3]?o-=9:o+=1;break;case 10:o=5===a[2]?o-=50:o+=10;break;case 60:o=9===a[1]?o-=540:o+=60;break;case 600:o=9===a[0]?o-=5400:o+=600}else switch(i){case 1:o=0===a[3]?o+=9:o-=1;break;case 10:o=0===a[2]?o+=50:o-=10;break;case 60:o=0===a[1]?o+=540:o-=60;break;case 600:o=0===a[0]?o+=5400:o-=600}"session"===t?(k=o,this.setParsedSessionDigits(this.parseFourDigits(k)),localStorage.setItem("session",k.toString())):(m=o,this.setParsedBreakDigits(this.parseFourDigits(m)),localStorage.setItem("break",m.toString())),S||(b=k,f=k,0===f?this.updateCounter():this.updateClock())},setParsedSessionDigits:function(e){n.text(e[0]),r.text(e[1]),c.text(e[2]),u.text(e[3])},setParsedBreakDigits:function(e){$("#break-minutes-tens").text(e[0]),$("#break-minutes-ones").text(e[1]),$("#break-seconds-tens").text(e[2]),$("#break-seconds-ones").text(e[3])},parseFourDigits:function(e){var t=0,s=0,i=0,a=0;a=Math.floor(e/60/10),i=Math.floor(e/60%10);var o=e-(600*a+60*i);return s=Math.floor(o/10),t=Math.floor(o%10),[a,i,s,t]},reset:function(){v&&this.startStop(),0===k?(b=m,f=m,p="break"):(b=k,f=k,p="session"),S=!1,this.updateClock()},init:function(){this.setAudio($("input[name=sfx]:checked","#sfx").val()),this.setParsedSessionDigits(this.parseFourDigits(k)),this.setParsedBreakDigits(this.parseFourDigits(m)),b=k,f=k,this.updateClock()}}};$(document).ready(function(){var e=localStorage.getItem("audio"),t=$.parseJSON(localStorage.getItem("session")),s=$.parseJSON(localStorage.getItem("break"));null!==e?($("#"+e).click(),$(":focus").blur()):localStorage.setItem("audio","chime"),null===t&&(localStorage.setItem("session","1500"),t=1500),null===s&&(localStorage.setItem("break","300"),s=300);var i=new Timer(t,s);i.init(),$(".btn-clock").on("click",function(e){i.startStop()}),$(".reset").on("click",function(e){i.reset()}),$(".edit-timer").on("click",function(e){e.preventDefault(),i.setSettingsTimer($(this).data("edit"),$(this).data("type"))}),$("#sfx input").on("change",function(){i.setAudio($("input[name=sfx]:checked","#sfx").val())})});